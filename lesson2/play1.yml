---

- name: Users creation

  become: yes
  become_method: sudo

  vars:
    users:
      - name: alice
        comment: "alice@localhost.net"
        home: "/home/alice"
        password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31333462616538353862373531313965323930623736303039316638333435376166313839616638
          6530656334373262363862616238383030653332646565620a623237303763313838646131653431
          34313834353031373330626130363932383963353831623034353637653361613539386139613064
          6564653865396432360a643434396361663966393332626264396361373632636361656631336165
          3831
      - name: bob
        comment: "bob@localhost.net"
        home: "/home/bob"
        password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66313063646662383436333638636664656161363561303637663739343461386262373731663032
          6537373265613365373565343663663339343934306631320a643137616564303061373564393430
          61396665316665376261346465303932646365336534343930343230623262363264616162376439
          6361316137383435330a313435303762306562373634656265323033303263336466643634313931
          3630
      - name: carol
        comment: "carol@somedomain.org"
        home: "/home/carol"
        password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          32636233633732643930303935646438663037656439636632343965343365316363663164666638
          3734623731383735633131313832333932383662343839360a613739303035316163376532663063
          31393631386432393339373861623363636335343363303231343535646537656362316636316436
          3837376335353261330a626433386238363965346262356361643161663835663661396361346431
          6636

  tasks:
    - name: Create users
      user:
        name: "{{ item.name }}"
        comment: "{{ item.comment }}"
        home: "{{ item.home }}"
        password: "{{ item.password | password_hash('sha512') }}"
        create_home: yes
        update_password: on_create
      loop: "{{ users }}"
